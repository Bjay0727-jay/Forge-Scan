<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1100 1050" font-family="'Segoe UI', system-ui, -apple-system, sans-serif">
  <defs>
    <linearGradient id="bgGrad" x1="0" y1="0" x2="0" y2="1">
      <stop offset="0%" stop-color="#0a0e17"/>
      <stop offset="100%" stop-color="#111827"/>
    </linearGradient>
    <linearGradient id="amberGrad" x1="0" y1="0" x2="1" y2="1">
      <stop offset="0%" stop-color="#f59e0b"/>
      <stop offset="100%" stop-color="#d97706"/>
    </linearGradient>
    <linearGradient id="skyGrad" x1="0" y1="0" x2="1" y2="1">
      <stop offset="0%" stop-color="#0ea5e9"/>
      <stop offset="100%" stop-color="#0284c7"/>
    </linearGradient>
    <linearGradient id="emeraldGrad" x1="0" y1="0" x2="1" y2="1">
      <stop offset="0%" stop-color="#10b981"/>
      <stop offset="100%" stop-color="#059669"/>
    </linearGradient>
    <linearGradient id="purpleGrad" x1="0" y1="0" x2="1" y2="1">
      <stop offset="0%" stop-color="#8b5cf6"/>
      <stop offset="100%" stop-color="#7c3aed"/>
    </linearGradient>
    <linearGradient id="redGrad" x1="0" y1="0" x2="1" y2="1">
      <stop offset="0%" stop-color="#ef4444"/>
      <stop offset="100%" stop-color="#dc2626"/>
    </linearGradient>
    <filter id="glow">
      <feGaussianBlur stdDeviation="3" result="blur"/>
      <feMerge><feMergeNode in="blur"/><feMergeNode in="SourceGraphic"/></feMerge>
    </filter>
    <filter id="shadow">
      <feDropShadow dx="0" dy="2" stdDeviation="4" flood-color="#000" flood-opacity="0.5"/>
    </filter>
    <marker id="arrowAmber" markerWidth="8" markerHeight="6" refX="8" refY="3" orient="auto">
      <path d="M0,0 L8,3 L0,6 Z" fill="#f59e0b"/>
    </marker>
    <marker id="arrowSky" markerWidth="8" markerHeight="6" refX="8" refY="3" orient="auto">
      <path d="M0,0 L8,3 L0,6 Z" fill="#0ea5e9"/>
    </marker>
    <marker id="arrowEmerald" markerWidth="8" markerHeight="6" refX="8" refY="3" orient="auto">
      <path d="M0,0 L8,3 L0,6 Z" fill="#10b981"/>
    </marker>
    <marker id="arrowRed" markerWidth="8" markerHeight="6" refX="8" refY="3" orient="auto">
      <path d="M0,0 L8,3 L0,6 Z" fill="#ef4444"/>
    </marker>
    <marker id="arrowPurple" markerWidth="8" markerHeight="6" refX="8" refY="3" orient="auto">
      <path d="M0,0 L8,3 L0,6 Z" fill="#8b5cf6"/>
    </marker>
    <pattern id="dots" width="20" height="20" patternUnits="userSpaceOnUse">
      <circle cx="10" cy="10" r="0.5" fill="#1e293b"/>
    </pattern>
  </defs>

  <!-- BACKGROUND -->
  <rect width="1100" height="1050" fill="url(#bgGrad)"/>
  <rect width="1100" height="1050" fill="url(#dots)"/>

  <!-- TITLE -->
  <text x="550" y="32" text-anchor="middle" fill="#f8fafc" font-size="18" font-weight="700" letter-spacing="0.5">ForgeScan 360 — Hybrid Scanning Architecture</text>
  <text x="550" y="52" text-anchor="middle" fill="#64748b" font-size="11">Forge Cyber Defense • Xiid SealedTunnel • Cloudflare + Hetzner + On-Prem • ~$8/mo</text>

  <!-- ═══════════════════════════════════════════════════════ -->
  <!-- CLOUDFLARE EDGE ZONE (amber) — top                    -->
  <!-- ═══════════════════════════════════════════════════════ -->
  <rect x="40" y="70" width="1020" height="155" rx="12" fill="none" stroke="#f59e0b" stroke-width="1" stroke-opacity="0.3" stroke-dasharray="6,4"/>
  <rect x="40" y="70" width="1020" height="28" rx="12" fill="#f59e0b" fill-opacity="0.08"/>
  <circle cx="58" cy="84" r="5" fill="#f59e0b"/>
  <text x="72" y="89" fill="#fbbf24" font-size="10" font-weight="700">CLOUDFLARE EDGE NETWORK</text>
  <text x="1040" y="89" text-anchor="end" fill="#92400e" font-size="9">Workers + Pages + D1/R2/KV</text>

  <!-- Workers API -->
  <rect x="60" y="108" width="280" height="105" rx="8" fill="#1a1400" stroke="#f59e0b" stroke-width="1" filter="url(#shadow)"/>
  <rect x="60" y="108" width="280" height="26" rx="8" fill="url(#amberGrad)" opacity="0.9"/>
  <text x="75" y="126" fill="#fff" font-size="10" font-weight="700">API Server</text>
  <text x="325" y="126" text-anchor="end" fill="#fef3c7" font-size="8">Cloudflare Workers</text>
  <text x="75" y="148" fill="#94a3b8" font-size="8.5">Hono + REST Framework</text>
  <text x="75" y="162" fill="#fcd34d" font-size="8">POST /api/v1/scanner/heartbeat</text>
  <text x="75" y="175" fill="#fcd34d" font-size="8">GET  /api/v1/scanner/tasks/next</text>
  <text x="75" y="188" fill="#fcd34d" font-size="8">POST /api/v1/scanner/tasks/:id/results</text>
  <text x="75" y="201" fill="#94a3b8" font-size="8">X-Scanner-Key auth</text>

  <!-- Dashboard -->
  <rect x="365" y="108" width="200" height="70" rx="8" fill="#1a1400" stroke="#f59e0b" stroke-width="1" filter="url(#shadow)"/>
  <rect x="365" y="108" width="200" height="26" rx="8" fill="url(#amberGrad)" opacity="0.9"/>
  <text x="380" y="126" fill="#fff" font-size="10" font-weight="700">Dashboard</text>
  <text x="550" y="126" text-anchor="end" fill="#fef3c7" font-size="8">Cloudflare Pages</text>
  <text x="380" y="148" fill="#94a3b8" font-size="8.5">React SPA + TailwindCSS</text>
  <text x="380" y="162" fill="#94a3b8" font-size="8.5">Scanner management console</text>

  <!-- D1 / R2 / KV -->
  <rect x="590" y="108" width="130" height="50" rx="8" fill="#1a1400" stroke="#f59e0b" stroke-width="0.8"/>
  <rect x="590" y="108" width="130" height="22" rx="8" fill="url(#amberGrad)" opacity="0.7"/>
  <text x="655" y="123" text-anchor="middle" fill="#fff" font-size="9" font-weight="700">D1 Database</text>
  <text x="605" y="142" fill="#94a3b8" font-size="8">Scans, tasks, findings</text>

  <rect x="745" y="108" width="110" height="50" rx="8" fill="#1a1400" stroke="#f59e0b" stroke-width="0.8"/>
  <rect x="745" y="108" width="110" height="22" rx="8" fill="url(#amberGrad)" opacity="0.7"/>
  <text x="800" y="123" text-anchor="middle" fill="#fff" font-size="9" font-weight="700">R2 Storage</text>
  <text x="760" y="142" fill="#94a3b8" font-size="8">Reports, exports</text>

  <rect x="880" y="108" width="165" height="50" rx="8" fill="#1a1400" stroke="#f59e0b" stroke-width="0.8"/>
  <rect x="880" y="108" width="165" height="22" rx="8" fill="url(#amberGrad)" opacity="0.7"/>
  <text x="963" y="123" text-anchor="middle" fill="#fff" font-size="9" font-weight="700">KV Cache</text>
  <text x="895" y="142" fill="#94a3b8" font-size="8">Sessions, rate limits</text>

  <!-- ═══════════════════════════════════════════════════════ -->
  <!-- XIID SEALEDTUNNEL ZONE (red) — middle                 -->
  <!-- ═══════════════════════════════════════════════════════ -->
  <rect x="40" y="245" width="1020" height="210" rx="12" fill="none" stroke="#ef4444" stroke-width="1" stroke-opacity="0.4" stroke-dasharray="6,4"/>
  <rect x="40" y="245" width="1020" height="28" rx="12" fill="#ef4444" fill-opacity="0.08"/>
  <circle cx="58" cy="259" r="5" fill="#ef4444"/>
  <text x="72" y="264" fill="#fca5a5" font-size="10" font-weight="700">XIID SEALEDTUNNEL INFRASTRUCTURE</text>
  <text x="1040" y="264" text-anchor="end" fill="#991b1b" font-size="9">Quantum-Secure • Triple-Encrypted • Zero Inbound</text>

  <!-- Connector Fleet (center) -->
  <rect x="350" y="285" width="300" height="65" rx="10" fill="#2a0a0a" stroke="#ef4444" stroke-width="1.5" filter="url(#shadow)"/>
  <rect x="350" y="285" width="300" height="65" rx="10" fill="url(#redGrad)" opacity="0.08"/>
  <text x="500" y="310" text-anchor="middle" fill="#fca5a5" font-size="12" font-weight="700">XIID CONNECTOR FLEET</text>
  <text x="500" y="326" text-anchor="middle" fill="#ef4444" font-size="8.5">Triple Encrypted • Quantum Secure • Geographic Clustering • Auto-Failover</text>
  <text x="500" y="340" text-anchor="middle" fill="#991b1b" font-size="8">Bridges two outbound-only tunnel halves — no inbound ports anywhere</text>

  <!-- Infra VM (right side of tunnel zone) -->
  <rect x="700" y="365" width="345" height="80" rx="8" fill="#2a0a0a" stroke="#ef4444" stroke-width="1" filter="url(#shadow)"/>
  <rect x="700" y="365" width="345" height="26" rx="8" fill="url(#redGrad)" opacity="0.9"/>
  <text x="715" y="383" fill="#fff" font-size="10" font-weight="700">forgescan-infra</text>
  <text x="1030" y="383" text-anchor="end" fill="#fecaca" font-size="8">CX22 • $4/mo • 10.0.1.20</text>
  <text x="715" y="405" fill="#fca5a5" font-size="8.5">Xiid Commander (management) + STLink exitpoint (127.0.0.1:8443-8444)</text>
  <text x="715" y="420" fill="#fca5a5" font-size="8.5">Caddy reverse proxy → https://forgescan-api.stanley-riley.workers.dev</text>
  <text x="715" y="435" fill="#991b1b" font-size="8">Outbound :443 only • Commander on private VLAN</text>

  <!-- Arrow: Connector Fleet → Infra exitpoint -->
  <path d="M 600 350 L 600 395 L 698 395" stroke="#ef4444" stroke-width="1.5" stroke-dasharray="6,4" fill="none" marker-end="url(#arrowRed)"/>
  <text x="630" y="388" fill="#991b1b" font-size="7">outbound :443</text>

  <!-- Arrow: Infra/Caddy → Cloudflare Workers API (up) -->
  <path d="M 870 365 L 870 235 L 300 235 L 300 213" stroke="#f59e0b" stroke-width="1.5" stroke-dasharray="6,4" fill="none" marker-end="url(#arrowAmber)"/>
  <rect x="520" y="228" width="130" height="14" rx="2" fill="#0a0e17"/>
  <text x="585" y="239" text-anchor="middle" fill="#fbbf24" font-size="7.5" font-weight="600">HTTPS :443 → Workers API</text>

  <!-- ═══════════════════════════════════════════════════════ -->
  <!-- HETZNER SCANNER ZONE (sky blue) — bottom left          -->
  <!-- ═══════════════════════════════════════════════════════ -->
  <rect x="40" y="480" width="470" height="200" rx="12" fill="none" stroke="#0ea5e9" stroke-width="1" stroke-opacity="0.4" stroke-dasharray="6,4"/>
  <rect x="40" y="480" width="470" height="28" rx="12" fill="#0ea5e9" fill-opacity="0.1"/>
  <circle cx="58" cy="494" r="5" fill="#0ea5e9"/>
  <text x="72" y="499" fill="#38bdf8" font-size="10" font-weight="700">HETZNER CLOUD — Falkenstein DC</text>
  <text x="495" y="499" text-anchor="end" fill="#0369a1" font-size="9">External Scanning</text>

  <!-- Scanner VM -->
  <rect x="60" y="520" width="290" height="145" rx="8" fill="#0c1f36" stroke="#0ea5e9" stroke-width="1" filter="url(#shadow)"/>
  <rect x="60" y="520" width="290" height="26" rx="8" fill="url(#skyGrad)" opacity="0.9"/>
  <text x="75" y="538" fill="#fff" font-size="10" font-weight="700">forgescan-scanner-ext</text>
  <text x="335" y="538" text-anchor="end" fill="#e0f2fe" font-size="8">CX22 • $4/mo</text>
  <text x="75" y="558" fill="#94a3b8" font-size="8.5">2 vCPU • 4 GB RAM • 40 GB NVMe</text>
  <text x="75" y="573" fill="#94a3b8" font-size="8.5">Docker + host networking + NET_RAW</text>
  <text x="75" y="590" fill="#38bdf8" font-size="8.5" font-weight="600">--platform http://127.0.0.5:443</text>
  <text x="75" y="607" fill="#7dd3fc" font-size="8.5">STLink client binds 127.0.0.5:443</text>
  <text x="75" y="622" fill="#7dd3fc" font-size="8.5">NVD DB: forgescan-nvd volume</text>
  <text x="75" y="640" fill="#0369a1" font-size="8">Scans external targets (public IPs + domains)</text>

  <!-- External targets -->
  <rect x="375" y="555" width="120" height="55" rx="6" fill="#1e293b" stroke="#64748b" stroke-width="0.8"/>
  <text x="435" y="575" text-anchor="middle" fill="#e2e8f0" font-size="9" font-weight="600">External Targets</text>
  <text x="435" y="590" text-anchor="middle" fill="#94a3b8" font-size="7.5">Public IPs</text>
  <text x="435" y="601" text-anchor="middle" fill="#94a3b8" font-size="7.5">Domains</text>
  <path d="M 350 582 L 373 582" stroke="#0ea5e9" stroke-width="1.5" stroke-dasharray="4,3" marker-end="url(#arrowSky)"/>

  <!-- Arrow: Scanner STLink → Connector Fleet (up) -->
  <path d="M 200 520 L 200 500 L 200 380 L 200 318 L 348 318" stroke="#ef4444" stroke-width="1.5" stroke-dasharray="6,4" fill="none" marker-end="url(#arrowRed)"/>
  <rect x="115" y="400" width="170" height="16" rx="3" fill="#ef4444" fill-opacity="0.08" stroke="#ef4444" stroke-width="0.5" stroke-opacity="0.3"/>
  <text x="200" y="411" text-anchor="middle" fill="#fca5a5" font-size="7.5" font-weight="600">STLink outbound :443 (encrypted)</text>

  <!-- ═══════════════════════════════════════════════════════ -->
  <!-- CUSTOMER ON-PREM ZONE (emerald) — bottom right         -->
  <!-- ═══════════════════════════════════════════════════════ -->
  <rect x="535" y="480" width="525" height="200" rx="12" fill="none" stroke="#10b981" stroke-width="1" stroke-opacity="0.4" stroke-dasharray="6,4"/>
  <rect x="535" y="480" width="525" height="28" rx="12" fill="#10b981" fill-opacity="0.1"/>
  <circle cx="553" cy="494" r="5" fill="#10b981"/>
  <text x="567" y="499" fill="#34d399" font-size="10" font-weight="700">CUSTOMER NETWORK — On-Premises</text>
  <text x="1045" y="499" text-anchor="end" fill="#065f46" font-size="9">Internal Scanning</text>

  <!-- Internal Scanner -->
  <rect x="555" y="520" width="290" height="145" rx="8" fill="#061f17" stroke="#10b981" stroke-width="1" filter="url(#shadow)"/>
  <rect x="555" y="520" width="290" height="26" rx="8" fill="url(#emeraldGrad)" opacity="0.9"/>
  <text x="570" y="538" fill="#fff" font-size="10" font-weight="700">forgescan-scanner-int</text>
  <text x="830" y="538" text-anchor="end" fill="#d1fae5" font-size="8">Customer HW</text>
  <text x="570" y="558" fill="#94a3b8" font-size="8.5">Native binary or Docker container</text>
  <text x="570" y="573" fill="#94a3b8" font-size="8.5">Linux systemd or Windows Service</text>
  <text x="570" y="590" fill="#34d399" font-size="8.5" font-weight="600">--platform http://127.0.0.5:443</text>
  <text x="570" y="607" fill="#6ee7b7" font-size="8.5">STLink client binds 127.0.0.5:443</text>
  <text x="570" y="622" fill="#6ee7b7" font-size="8.5">NVD DB: /var/lib/forgescan/nvd.db</text>
  <text x="570" y="640" fill="#065f46" font-size="8">Scans internal targets (RFC1918)</text>

  <!-- Internal targets -->
  <rect x="870" y="520" width="175" height="145" rx="8" fill="#10b981" fill-opacity="0.05" stroke="#10b981" stroke-width="0.8" stroke-opacity="0.3"/>
  <text x="957" y="540" text-anchor="middle" fill="#34d399" font-size="9" font-weight="600">Internal Targets</text>
  <text x="957" y="555" text-anchor="middle" fill="#6ee7b7" font-size="8" font-weight="600">RFC1918</text>
  <text x="885" y="575" fill="#94a3b8" font-size="8">192.168.x.x</text>
  <text x="885" y="590" fill="#94a3b8" font-size="8">10.x.x.x</text>
  <text x="885" y="605" fill="#94a3b8" font-size="8">172.16.x.x</text>
  <text x="885" y="625" fill="#64748b" font-size="8">Servers / Switches</text>
  <text x="885" y="640" fill="#64748b" font-size="8">IoT / SCADA</text>
  <text x="885" y="655" fill="#64748b" font-size="8">Printers / Routers</text>
  <path d="M 845 590 L 868 590" stroke="#10b981" stroke-width="1.5" stroke-dasharray="4,3" marker-end="url(#arrowEmerald)"/>

  <!-- Arrow: On-prem STLink → Connector Fleet (up) -->
  <path d="M 700 520 L 700 470 L 500 470 L 500 350" stroke="#ef4444" stroke-width="1.5" stroke-dasharray="6,4" fill="none" marker-end="url(#arrowRed)"/>
  <rect x="530" y="462" width="170" height="16" rx="3" fill="#ef4444" fill-opacity="0.08" stroke="#ef4444" stroke-width="0.5" stroke-opacity="0.3"/>
  <text x="615" y="473" text-anchor="middle" fill="#fca5a5" font-size="7.5" font-weight="600">STLink outbound :443 (encrypted)</text>

  <!-- ═══════════════════════════════════════════════════════ -->
  <!-- GITHUB CI/CD ZONE (purple) — bottom                    -->
  <!-- ═══════════════════════════════════════════════════════ -->
  <rect x="40" y="710" width="1020" height="155" rx="12" fill="none" stroke="#8b5cf6" stroke-width="1" stroke-opacity="0.3" stroke-dasharray="6,4"/>
  <rect x="40" y="710" width="1020" height="28" rx="12" fill="#8b5cf6" fill-opacity="0.08"/>
  <circle cx="58" cy="724" r="5" fill="#8b5cf6"/>
  <text x="72" y="729" fill="#a78bfa" font-size="10" font-weight="700">GITHUB CI/CD PIPELINE</text>
  <text x="1040" y="729" text-anchor="end" fill="#5b21b6" font-size="9">Build • Test • Deploy</text>

  <!-- Actions -->
  <rect x="60" y="750" width="230" height="60" rx="8" fill="#1e1145" stroke="#8b5cf6" stroke-width="1" filter="url(#shadow)"/>
  <rect x="60" y="750" width="230" height="22" rx="8" fill="url(#purpleGrad)" opacity="0.9"/>
  <text x="75" y="766" fill="#fff" font-size="9" font-weight="700">GitHub Actions</text>
  <text x="75" y="785" fill="#a78bfa" font-size="8">ci.yml • build-docker.yml</text>
  <text x="75" y="798" fill="#a78bfa" font-size="8">release-binaries.yml</text>

  <!-- GHCR -->
  <rect x="320" y="750" width="230" height="60" rx="8" fill="#1e1145" stroke="#8b5cf6" stroke-width="1" filter="url(#shadow)"/>
  <rect x="320" y="750" width="230" height="22" rx="8" fill="url(#purpleGrad)" opacity="0.9"/>
  <text x="335" y="766" fill="#fff" font-size="9" font-weight="700">GHCR</text>
  <text x="535" y="766" text-anchor="end" fill="#e9d5ff" font-size="8">Container Registry</text>
  <text x="335" y="785" fill="#94a3b8" font-size="8">ghcr.io/bjay0727-jay/forgescan-scanner</text>
  <text x="335" y="798" fill="#a78bfa" font-size="8">linux/amd64 + linux/arm64</text>

  <!-- Releases -->
  <rect x="580" y="750" width="230" height="60" rx="8" fill="#1e1145" stroke="#8b5cf6" stroke-width="1" filter="url(#shadow)"/>
  <rect x="580" y="750" width="230" height="22" rx="8" fill="url(#purpleGrad)" opacity="0.9"/>
  <text x="595" y="766" fill="#fff" font-size="9" font-weight="700">GitHub Releases</text>
  <text x="795" y="766" text-anchor="end" fill="#e9d5ff" font-size="8">Static Binaries</text>
  <text x="595" y="785" fill="#94a3b8" font-size="8">linux-amd64 / linux-arm64 / windows</text>
  <text x="595" y="798" fill="#a78bfa" font-size="8">cross-rs builds</text>

  <!-- CI flow arrows -->
  <line x1="290" y1="780" x2="318" y2="780" stroke="#8b5cf6" stroke-width="1" stroke-dasharray="4,3" marker-end="url(#arrowPurple)"/>
  <line x1="550" y1="780" x2="578" y2="780" stroke="#8b5cf6" stroke-width="1" stroke-dasharray="4,3" marker-end="url(#arrowPurple)"/>

  <!-- Deploy arrows to scanners -->
  <path d="M 435 750 L 435 700 L 200 700 L 200 680" stroke="#8b5cf6" stroke-width="1" stroke-dasharray="3,3" fill="none" marker-end="url(#arrowPurple)" opacity="0.5"/>
  <text x="300" y="695" text-anchor="middle" fill="#a78bfa" font-size="7">docker pull</text>

  <path d="M 695 750 L 695 700 L 700 700 L 700 680" stroke="#8b5cf6" stroke-width="1" stroke-dasharray="3,3" fill="none" marker-end="url(#arrowPurple)" opacity="0.5"/>
  <text x="720" y="695" fill="#a78bfa" font-size="7">binary</text>

  <!-- ═══════════════════════════════════════════════════════ -->
  <!-- LEGEND BAR                                             -->
  <!-- ═══════════════════════════════════════════════════════ -->
  <rect x="40" y="890" width="1020" height="55" rx="8" fill="#1e293b" fill-opacity="0.5" stroke="#334155" stroke-width="0.5"/>

  <circle cx="70" cy="907" r="4" fill="#f59e0b"/>
  <text x="80" y="911" fill="#94a3b8" font-size="8">Cloudflare</text>
  <circle cx="150" cy="907" r="4" fill="#ef4444"/>
  <text x="160" y="911" fill="#94a3b8" font-size="8">Xiid SealedTunnel</text>
  <circle cx="265" cy="907" r="4" fill="#0ea5e9"/>
  <text x="275" y="911" fill="#94a3b8" font-size="8">Hetzner</text>
  <circle cx="335" cy="907" r="4" fill="#10b981"/>
  <text x="345" y="911" fill="#94a3b8" font-size="8">On-Prem</text>
  <circle cx="405" cy="907" r="4" fill="#8b5cf6"/>
  <text x="415" y="911" fill="#94a3b8" font-size="8">CI/CD</text>

  <text x="500" y="911" fill="#64748b" font-size="8">All scanner connections outbound-only port 443 via Xiid SealedTunnel</text>
  <text x="500" y="926" fill="#64748b" font-size="8">Quantum-resistant encryption • Zero inbound ports • No VPN required</text>
  <text x="500" y="940" fill="#64748b" font-size="8">X-Scanner-Key auth • STLink loopback 127.0.0.5:443 • Caddy exitpoint proxy</text>

  <rect x="980" y="900" width="65" height="30" rx="4" fill="#ef4444" fill-opacity="0.1" stroke="#ef4444" stroke-width="0.5" stroke-opacity="0.3"/>
  <text x="1013" y="920" text-anchor="middle" fill="#fca5a5" font-size="9" font-weight="700">SEALED</text>
</svg>
