<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1100 900" font-family="'Segoe UI', system-ui, -apple-system, sans-serif">
  <defs>
    <!-- Background gradient -->
    <linearGradient id="bgGrad" x1="0" y1="0" x2="0" y2="1">
      <stop offset="0%" stop-color="#0a0e17"/>
      <stop offset="100%" stop-color="#111827"/>
    </linearGradient>
    <!-- Zone header gradients -->
    <linearGradient id="amberGrad" x1="0" y1="0" x2="1" y2="1">
      <stop offset="0%" stop-color="#f59e0b"/>
      <stop offset="100%" stop-color="#d97706"/>
    </linearGradient>
    <linearGradient id="skyGrad" x1="0" y1="0" x2="1" y2="1">
      <stop offset="0%" stop-color="#0ea5e9"/>
      <stop offset="100%" stop-color="#0284c7"/>
    </linearGradient>
    <linearGradient id="emeraldGrad" x1="0" y1="0" x2="1" y2="1">
      <stop offset="0%" stop-color="#10b981"/>
      <stop offset="100%" stop-color="#059669"/>
    </linearGradient>
    <linearGradient id="purpleGrad" x1="0" y1="0" x2="1" y2="1">
      <stop offset="0%" stop-color="#8b5cf6"/>
      <stop offset="100%" stop-color="#7c3aed"/>
    </linearGradient>
    <!-- Filters -->
    <filter id="glow">
      <feGaussianBlur stdDeviation="3" result="blur"/>
      <feMerge><feMergeNode in="blur"/><feMergeNode in="SourceGraphic"/></feMerge>
    </filter>
    <filter id="shadow">
      <feDropShadow dx="0" dy="2" stdDeviation="4" flood-color="#000" flood-opacity="0.5"/>
    </filter>
    <!-- Arrow markers -->
    <marker id="arrowAmber" markerWidth="8" markerHeight="6" refX="8" refY="3" orient="auto">
      <path d="M0,0 L8,3 L0,6 Z" fill="#f59e0b"/>
    </marker>
    <marker id="arrowSky" markerWidth="8" markerHeight="6" refX="8" refY="3" orient="auto">
      <path d="M0,0 L8,3 L0,6 Z" fill="#0ea5e9"/>
    </marker>
    <marker id="arrowEmerald" markerWidth="8" markerHeight="6" refX="8" refY="3" orient="auto">
      <path d="M0,0 L8,3 L0,6 Z" fill="#10b981"/>
    </marker>
    <marker id="arrowPurple" markerWidth="8" markerHeight="6" refX="8" refY="3" orient="auto">
      <path d="M0,0 L8,3 L0,6 Z" fill="#8b5cf6"/>
    </marker>
    <marker id="arrowGray" markerWidth="8" markerHeight="6" refX="8" refY="3" orient="auto">
      <path d="M0,0 L8,3 L0,6 Z" fill="#64748b"/>
    </marker>
    <!-- Dot grid pattern -->
    <pattern id="dots" width="20" height="20" patternUnits="userSpaceOnUse">
      <circle cx="10" cy="10" r="0.5" fill="#1e293b"/>
    </pattern>
  </defs>

  <!-- ═══════════════════════════════════════════════════════ -->
  <!-- BACKGROUND                                             -->
  <!-- ═══════════════════════════════════════════════════════ -->
  <rect width="1100" height="900" fill="url(#bgGrad)"/>
  <rect width="1100" height="900" fill="url(#dots)"/>

  <!-- ═══════════════════════════════════════════════════════ -->
  <!-- TITLE BAR                                              -->
  <!-- ═══════════════════════════════════════════════════════ -->
  <text x="550" y="32" text-anchor="middle" fill="#f8fafc" font-size="18" font-weight="700" letter-spacing="0.5">ForgeScan 360 — Hybrid Scanning Architecture</text>
  <text x="550" y="52" text-anchor="middle" fill="#64748b" font-size="11">Forge Cyber Defense • Cloudflare + Hetzner + On-Prem • ~$4/mo scanner</text>

  <!-- ═══════════════════════════════════════════════════════ -->
  <!-- CLOUDFLARE EDGE ZONE (amber)                           -->
  <!-- ═══════════════════════════════════════════════════════ -->
  <rect x="40" y="70" width="1020" height="220" rx="12" fill="none" stroke="#f59e0b" stroke-width="1" stroke-opacity="0.3" stroke-dasharray="6,4"/>
  <rect x="40" y="70" width="1020" height="28" rx="12" fill="#f59e0b" fill-opacity="0.08"/>
  <circle cx="58" cy="84" r="5" fill="#f59e0b"/>
  <text x="72" y="89" fill="#fbbf24" font-size="10" font-weight="700">CLOUDFLARE EDGE NETWORK</text>
  <text x="1040" y="89" text-anchor="end" fill="#92400e" font-size="9">Workers + Pages + D1/R2/KV</text>

  <!-- Workers API node -->
  <rect x="60" y="110" width="290" height="165" rx="8" fill="#1a1400" stroke="#f59e0b" stroke-width="1" filter="url(#shadow)"/>
  <rect x="60" y="110" width="290" height="30" rx="8" fill="url(#amberGrad)" opacity="0.9"/>
  <text x="75" y="130" fill="#fff" font-size="11" font-weight="700">API Server</text>
  <text x="335" y="130" text-anchor="end" fill="#fef3c7" font-size="9">Cloudflare Workers</text>

  <text x="75" y="155" fill="#94a3b8" font-size="9">Hono + REST Framework</text>
  <text x="75" y="170" fill="#94a3b8" font-size="9">JWT Auth + X-Scanner-Key Auth</text>
  <text x="75" y="190" fill="#fbbf24" font-size="9" font-weight="600">Scanner Endpoints:</text>
  <text x="75" y="205" fill="#fcd34d" font-size="8.5">POST /api/v1/scanners/heartbeat</text>
  <text x="75" y="218" fill="#fcd34d" font-size="8.5">GET  /api/v1/tasks/next</text>
  <text x="75" y="231" fill="#fcd34d" font-size="8.5">POST /api/v1/tasks/:id/start</text>
  <text x="75" y="244" fill="#fcd34d" font-size="8.5">POST /api/v1/tasks/:id/results</text>
  <text x="75" y="257" fill="#fcd34d" font-size="8.5">POST /api/v1/tasks/:id/failure</text>

  <!-- Pages Dashboard node -->
  <rect x="380" y="110" width="220" height="100" rx="8" fill="#1a1400" stroke="#f59e0b" stroke-width="1" filter="url(#shadow)"/>
  <rect x="380" y="110" width="220" height="30" rx="8" fill="url(#amberGrad)" opacity="0.9"/>
  <text x="395" y="130" fill="#fff" font-size="11" font-weight="700">Dashboard</text>
  <text x="585" y="130" text-anchor="end" fill="#fef3c7" font-size="9">Cloudflare Pages</text>

  <text x="395" y="155" fill="#94a3b8" font-size="9">React SPA + TailwindCSS</text>
  <text x="395" y="170" fill="#94a3b8" font-size="9">Scanner management console</text>
  <text x="395" y="185" fill="#94a3b8" font-size="9">Real-time scan monitoring</text>
  <text x="395" y="200" fill="#94a3b8" font-size="9">Vulnerability reports + exports</text>

  <!-- fetch() arrow from Pages to Workers -->
  <line x1="380" y1="160" x2="352" y2="160" stroke="#f59e0b" stroke-width="1" stroke-dasharray="4,3" marker-end="url(#arrowAmber)"/>
  <text x="366" y="153" text-anchor="middle" fill="#92400e" font-size="7">fetch()</text>

  <!-- D1 node -->
  <rect x="630" y="110" width="130" height="70" rx="8" fill="#1a1400" stroke="#f59e0b" stroke-width="1" filter="url(#shadow)"/>
  <rect x="630" y="110" width="130" height="24" rx="8" fill="url(#amberGrad)" opacity="0.7"/>
  <text x="695" y="126" text-anchor="middle" fill="#fff" font-size="10" font-weight="700">D1 Database</text>
  <text x="645" y="148" fill="#94a3b8" font-size="8.5">SQLite at edge</text>
  <text x="645" y="161" fill="#94a3b8" font-size="8.5">Scans, tasks, findings</text>
  <text x="645" y="174" fill="#94a3b8" font-size="8.5">Assets, scanners</text>

  <!-- R2 node -->
  <rect x="785" y="110" width="130" height="70" rx="8" fill="#1a1400" stroke="#f59e0b" stroke-width="1" filter="url(#shadow)"/>
  <rect x="785" y="110" width="130" height="24" rx="8" fill="url(#amberGrad)" opacity="0.7"/>
  <text x="850" y="126" text-anchor="middle" fill="#fff" font-size="10" font-weight="700">R2 Storage</text>
  <text x="800" y="148" fill="#94a3b8" font-size="8.5">Object storage</text>
  <text x="800" y="161" fill="#94a3b8" font-size="8.5">PDF reports</text>
  <text x="800" y="174" fill="#94a3b8" font-size="8.5">CSV/JSON exports</text>

  <!-- KV node -->
  <rect x="940" y="110" width="105" height="70" rx="8" fill="#1a1400" stroke="#f59e0b" stroke-width="1" filter="url(#shadow)"/>
  <rect x="940" y="110" width="105" height="24" rx="8" fill="url(#amberGrad)" opacity="0.7"/>
  <text x="993" y="126" text-anchor="middle" fill="#fff" font-size="10" font-weight="700">KV Cache</text>
  <text x="955" y="148" fill="#94a3b8" font-size="8.5">Sessions</text>
  <text x="955" y="161" fill="#94a3b8" font-size="8.5">NVD metadata</text>
  <text x="955" y="174" fill="#94a3b8" font-size="8.5">Rate limits</text>

  <!-- ═══════════════════════════════════════════════════════ -->
  <!-- CONNECTION LINES: Cloudflare → Scanners                -->
  <!-- ═══════════════════════════════════════════════════════ -->

  <!-- Hetzner scanner → Workers API (left side) -->
  <path d="M 200 290 L 200 350" stroke="#f59e0b" stroke-width="1.5" stroke-dasharray="6,4" fill="none" marker-end="url(#arrowAmber)"/>
  <rect x="130" y="308" width="140" height="18" rx="3" fill="#f59e0b" fill-opacity="0.08" stroke="#f59e0b" stroke-width="0.5" stroke-opacity="0.3"/>
  <text x="200" y="320" text-anchor="middle" fill="#fbbf24" font-size="8" font-weight="600">HTTPS :443 ↑ outbound</text>

  <!-- On-prem scanner → Workers API (right side) -->
  <path d="M 700 290 L 700 350" stroke="#f59e0b" stroke-width="1.5" stroke-dasharray="6,4" fill="none" marker-end="url(#arrowAmber)"/>
  <rect x="630" y="308" width="140" height="18" rx="3" fill="#f59e0b" fill-opacity="0.08" stroke="#f59e0b" stroke-width="0.5" stroke-opacity="0.3"/>
  <text x="700" y="320" text-anchor="middle" fill="#fbbf24" font-size="8" font-weight="600">HTTPS :443 ↑ outbound</text>

  <!-- ═══════════════════════════════════════════════════════ -->
  <!-- HETZNER CLOUD ZONE (sky blue) — middle left            -->
  <!-- ═══════════════════════════════════════════════════════ -->
  <rect x="40" y="355" width="470" height="240" rx="12" fill="none" stroke="#0ea5e9" stroke-width="1" stroke-opacity="0.4" stroke-dasharray="6,4"/>
  <rect x="40" y="355" width="470" height="28" rx="12" fill="#0ea5e9" fill-opacity="0.1"/>
  <circle cx="58" cy="369" r="5" fill="#0ea5e9"/>
  <text x="72" y="374" fill="#38bdf8" font-size="10" font-weight="700">HETZNER CLOUD — Falkenstein DC</text>
  <text x="495" y="374" text-anchor="end" fill="#0369a1" font-size="9">External Scanning</text>

  <!-- Scanner VM node -->
  <rect x="60" y="395" width="310" height="185" rx="8" fill="#0c1f36" stroke="#0ea5e9" stroke-width="1" filter="url(#shadow)"/>
  <rect x="60" y="395" width="310" height="30" rx="8" fill="url(#skyGrad)" opacity="0.9"/>
  <text x="75" y="415" fill="#fff" font-size="11" font-weight="700">forgescan-scanner-ext</text>
  <text x="355" y="415" text-anchor="end" fill="#e0f2fe" font-size="9">CX22 • $4/mo</text>

  <text x="75" y="440" fill="#94a3b8" font-size="9">2 vCPU (AMD) • 4 GB RAM • 40 GB NVMe</text>
  <text x="75" y="455" fill="#94a3b8" font-size="9">Ubuntu 22.04 LTS • Docker CE</text>
  <text x="75" y="475" fill="#38bdf8" font-size="9" font-weight="600">Docker Configuration:</text>
  <text x="75" y="490" fill="#7dd3fc" font-size="8.5">--network host</text>
  <text x="75" y="503" fill="#7dd3fc" font-size="8.5">--cap-add NET_RAW --cap-add NET_ADMIN</text>
  <text x="75" y="516" fill="#7dd3fc" font-size="8.5">-v forgescan-nvd:/var/lib/forgescan</text>
  <text x="75" y="535" fill="#38bdf8" font-size="9" font-weight="600">Services:</text>
  <text x="75" y="550" fill="#7dd3fc" font-size="8.5">forgescan-scanner daemon (task polling)</text>
  <text x="75" y="563" fill="#7dd3fc" font-size="8.5">NVD DB sync (local vulnerability data)</text>

  <!-- NVD Volume -->
  <rect x="395" y="430" width="100" height="55" rx="6" fill="#0c1f36" stroke="#0ea5e9" stroke-width="0.8"/>
  <text x="445" y="453" text-anchor="middle" fill="#38bdf8" font-size="9" font-weight="600">NVD DB</text>
  <text x="445" y="468" text-anchor="middle" fill="#94a3b8" font-size="8">Docker Vol</text>
  <text x="445" y="480" text-anchor="middle" fill="#94a3b8" font-size="8">nvd.db</text>
  <!-- NVD link -->
  <line x1="370" y1="457" x2="393" y2="457" stroke="#0ea5e9" stroke-width="0.8" stroke-opacity="0.5"/>

  <!-- External targets box -->
  <rect x="395" y="510" width="100" height="68" rx="6" fill="#1e293b" stroke="#64748b" stroke-width="0.8"/>
  <text x="445" y="530" text-anchor="middle" fill="#e2e8f0" font-size="9" font-weight="600">External</text>
  <text x="445" y="543" text-anchor="middle" fill="#e2e8f0" font-size="9" font-weight="600">Targets</text>
  <text x="445" y="558" text-anchor="middle" fill="#94a3b8" font-size="7.5">Public IPs</text>
  <text x="445" y="570" text-anchor="middle" fill="#94a3b8" font-size="7.5">Domains</text>

  <!-- Scan traffic: scanner → external targets -->
  <path d="M 370 540 L 393 540" stroke="#0ea5e9" stroke-width="1.5" stroke-dasharray="4,3" marker-end="url(#arrowSky)"/>
  <text x="382" y="533" text-anchor="middle" fill="#0369a1" font-size="6.5">SYN</text>

  <!-- ═══════════════════════════════════════════════════════ -->
  <!-- CUSTOMER ON-PREM ZONE (emerald) — middle right         -->
  <!-- ═══════════════════════════════════════════════════════ -->
  <rect x="535" y="355" width="525" height="240" rx="12" fill="none" stroke="#10b981" stroke-width="1" stroke-opacity="0.4" stroke-dasharray="6,4"/>
  <rect x="535" y="355" width="525" height="28" rx="12" fill="#10b981" fill-opacity="0.1"/>
  <circle cx="553" cy="369" r="5" fill="#10b981"/>
  <text x="567" y="374" fill="#34d399" font-size="10" font-weight="700">CUSTOMER NETWORK — On-Premises</text>
  <text x="1045" y="374" text-anchor="end" fill="#065f46" font-size="9">Internal Scanning</text>

  <!-- Internal Scanner node -->
  <rect x="555" y="395" width="290" height="185" rx="8" fill="#061f17" stroke="#10b981" stroke-width="1" filter="url(#shadow)"/>
  <rect x="555" y="395" width="290" height="30" rx="8" fill="url(#emeraldGrad)" opacity="0.9"/>
  <text x="570" y="415" fill="#fff" font-size="11" font-weight="700">forgescan-scanner-int</text>
  <text x="830" y="415" text-anchor="end" fill="#d1fae5" font-size="9">Customer HW</text>

  <text x="570" y="440" fill="#94a3b8" font-size="9">Native binary or Docker container</text>
  <text x="570" y="455" fill="#94a3b8" font-size="9">Linux (systemd) or Windows (Service)</text>
  <text x="570" y="475" fill="#34d399" font-size="9" font-weight="600">Linux systemd Capabilities:</text>
  <text x="570" y="490" fill="#6ee7b7" font-size="8.5">AmbientCapabilities=CAP_NET_RAW</text>
  <text x="570" y="503" fill="#6ee7b7" font-size="8.5">AmbientCapabilities=CAP_NET_ADMIN</text>
  <text x="570" y="516" fill="#6ee7b7" font-size="8.5">User=forgescan (non-root)</text>
  <text x="570" y="535" fill="#34d399" font-size="9" font-weight="600">Services:</text>
  <text x="570" y="550" fill="#6ee7b7" font-size="8.5">forgescan-scanner daemon (task polling)</text>
  <text x="570" y="563" fill="#6ee7b7" font-size="8.5">NVD DB local (/var/lib/forgescan/nvd.db)</text>

  <!-- Internal Targets sub-zone -->
  <rect x="870" y="395" width="175" height="185" rx="8" fill="#10b981" fill-opacity="0.05" stroke="#10b981" stroke-width="0.8" stroke-opacity="0.3"/>
  <text x="957" y="415" text-anchor="middle" fill="#34d399" font-size="9" font-weight="600">Internal Targets</text>
  <text x="957" y="433" text-anchor="middle" fill="#6ee7b7" font-size="8" font-weight="600">RFC1918</text>

  <text x="885" y="458" fill="#94a3b8" font-size="8.5">192.168.x.x</text>
  <text x="885" y="473" fill="#94a3b8" font-size="8.5">10.x.x.x</text>
  <text x="885" y="488" fill="#94a3b8" font-size="8.5">172.16.x.x</text>

  <text x="885" y="512" fill="#64748b" font-size="8">Servers</text>
  <text x="885" y="525" fill="#64748b" font-size="8">Switches / Routers</text>
  <text x="885" y="538" fill="#64748b" font-size="8">IoT Devices</text>
  <text x="885" y="551" fill="#64748b" font-size="8">Printers</text>
  <text x="885" y="564" fill="#64748b" font-size="8">SCADA / ICS</text>

  <!-- Scan traffic: scanner → internal targets -->
  <path d="M 845 490 L 868 490" stroke="#10b981" stroke-width="1.5" stroke-dasharray="4,3" marker-end="url(#arrowEmerald)"/>
  <text x="857" y="483" text-anchor="middle" fill="#065f46" font-size="6.5">SYN</text>

  <!-- ═══════════════════════════════════════════════════════ -->
  <!-- INTERNET / USER ZONE (top left floating)               -->
  <!-- ═══════════════════════════════════════════════════════ -->
  <!-- User icon connecting to Cloudflare -->
  <!-- (Represented by connection labels on the Cloudflare zone) -->

  <!-- ═══════════════════════════════════════════════════════ -->
  <!-- GITHUB CI/CD ZONE (purple) — bottom                    -->
  <!-- ═══════════════════════════════════════════════════════ -->
  <rect x="40" y="625" width="1020" height="200" rx="12" fill="none" stroke="#8b5cf6" stroke-width="1" stroke-opacity="0.3" stroke-dasharray="6,4"/>
  <rect x="40" y="625" width="1020" height="28" rx="12" fill="#8b5cf6" fill-opacity="0.08"/>
  <circle cx="58" cy="639" r="5" fill="#8b5cf6"/>
  <text x="72" y="644" fill="#a78bfa" font-size="10" font-weight="700">GITHUB CI/CD PIPELINE</text>
  <text x="1040" y="644" text-anchor="end" fill="#5b21b6" font-size="9">Build • Test • Deploy</text>

  <!-- Repo node -->
  <rect x="60" y="665" width="200" height="85" rx="8" fill="#1e1145" stroke="#8b5cf6" stroke-width="1" filter="url(#shadow)"/>
  <rect x="60" y="665" width="200" height="26" rx="8" fill="url(#purpleGrad)" opacity="0.9"/>
  <text x="75" y="683" fill="#fff" font-size="10" font-weight="700">Forge-Scan Repo</text>
  <text x="245" y="683" text-anchor="end" fill="#e9d5ff" font-size="8">github.com</text>
  <text x="75" y="705" fill="#94a3b8" font-size="8.5">Bjay0727-jay/Forge-Scan</text>
  <text x="75" y="718" fill="#94a3b8" font-size="8.5">Rust workspace (14 crates)</text>
  <text x="75" y="731" fill="#94a3b8" font-size="8.5">Cloudflare Workers + Pages</text>
  <text x="75" y="744" fill="#94a3b8" font-size="8.5">Deploy scripts</text>

  <!-- Actions node -->
  <rect x="310" y="665" width="200" height="85" rx="8" fill="#1e1145" stroke="#8b5cf6" stroke-width="1" filter="url(#shadow)"/>
  <rect x="310" y="665" width="200" height="26" rx="8" fill="url(#purpleGrad)" opacity="0.9"/>
  <text x="325" y="683" fill="#fff" font-size="10" font-weight="700">GitHub Actions</text>
  <text x="495" y="683" text-anchor="end" fill="#e9d5ff" font-size="8">CI/CD</text>
  <text x="325" y="705" fill="#a78bfa" font-size="8.5">ci.yml — fmt + clippy + test</text>
  <text x="325" y="718" fill="#a78bfa" font-size="8.5">build-docker.yml — multi-arch</text>
  <text x="325" y="731" fill="#a78bfa" font-size="8.5">release-binaries.yml — cross</text>
  <text x="325" y="744" fill="#94a3b8" font-size="8.5">Swatinem/rust-cache@v2</text>

  <!-- GHCR node -->
  <rect x="560" y="665" width="200" height="85" rx="8" fill="#1e1145" stroke="#8b5cf6" stroke-width="1" filter="url(#shadow)"/>
  <rect x="560" y="665" width="200" height="26" rx="8" fill="url(#purpleGrad)" opacity="0.9"/>
  <text x="575" y="683" fill="#fff" font-size="10" font-weight="700">GHCR</text>
  <text x="745" y="683" text-anchor="end" fill="#e9d5ff" font-size="8">Container Registry</text>
  <text x="575" y="705" fill="#94a3b8" font-size="8.5">ghcr.io/bjay0727-jay/</text>
  <text x="575" y="718" fill="#94a3b8" font-size="8.5">  forgescan-scanner</text>
  <text x="575" y="735" fill="#a78bfa" font-size="8.5">linux/amd64 + linux/arm64</text>
  <text x="575" y="748" fill="#94a3b8" font-size="8.5">Tags: latest, vX.Y.Z, sha-*</text>

  <!-- Releases node -->
  <rect x="810" y="665" width="235" height="85" rx="8" fill="#1e1145" stroke="#8b5cf6" stroke-width="1" filter="url(#shadow)"/>
  <rect x="810" y="665" width="235" height="26" rx="8" fill="url(#purpleGrad)" opacity="0.9"/>
  <text x="825" y="683" fill="#fff" font-size="10" font-weight="700">GitHub Releases</text>
  <text x="1030" y="683" text-anchor="end" fill="#e9d5ff" font-size="8">Static Binaries</text>
  <text x="825" y="705" fill="#94a3b8" font-size="8.5">forgescan-scanner-linux-amd64.tar.gz</text>
  <text x="825" y="718" fill="#94a3b8" font-size="8.5">forgescan-scanner-linux-arm64.tar.gz</text>
  <text x="825" y="731" fill="#94a3b8" font-size="8.5">forgescan-scanner-windows-amd64.zip</text>
  <text x="825" y="748" fill="#a78bfa" font-size="8.5">cross-rs builds via Cross.toml</text>

  <!-- CI/CD flow arrows -->
  <!-- Repo → Actions -->
  <line x1="260" y1="707" x2="308" y2="707" stroke="#8b5cf6" stroke-width="1" stroke-dasharray="4,3" marker-end="url(#arrowPurple)"/>
  <text x="284" y="700" text-anchor="middle" fill="#6d28d9" font-size="7">push/tag</text>

  <!-- Actions → GHCR -->
  <line x1="510" y1="700" x2="558" y2="700" stroke="#8b5cf6" stroke-width="1" stroke-dasharray="4,3" marker-end="url(#arrowPurple)"/>
  <text x="534" y="693" text-anchor="middle" fill="#6d28d9" font-size="7">docker push</text>

  <!-- Actions → Releases -->
  <line x1="510" y1="720" x2="808" y2="720" stroke="#8b5cf6" stroke-width="1" stroke-dasharray="4,3" marker-end="url(#arrowPurple)"/>
  <text x="659" y="713" text-anchor="middle" fill="#6d28d9" font-size="7">upload artifacts</text>

  <!-- ═══════════════════════════════════════════════════════ -->
  <!-- DEPLOY LINES: GHCR/Releases → Scanners                -->
  <!-- ═══════════════════════════════════════════════════════ -->

  <!-- GHCR → Hetzner scanner (dotted, docker pull) -->
  <path d="M 660 665 L 660 610 L 200 610 L 200 595" stroke="#8b5cf6" stroke-width="1" stroke-dasharray="3,3" fill="none" marker-end="url(#arrowPurple)" opacity="0.6"/>
  <rect x="370" y="602" width="80" height="14" rx="2" fill="#0a0e17"/>
  <text x="410" y="612" text-anchor="middle" fill="#a78bfa" font-size="7">docker pull</text>

  <!-- GHCR → On-prem scanner (dotted, docker pull) -->
  <path d="M 680 665 L 680 610 L 700 610 L 700 595" stroke="#8b5cf6" stroke-width="1" stroke-dasharray="3,3" fill="none" marker-end="url(#arrowPurple)" opacity="0.6"/>
  <rect x="672" y="602" width="80" height="14" rx="2" fill="#0a0e17"/>
  <text x="712" y="612" text-anchor="middle" fill="#a78bfa" font-size="7">docker pull</text>

  <!-- Releases → On-prem scanner (dotted, binary download) -->
  <path d="M 928 665 L 928 610 L 780 610 L 780 595" stroke="#8b5cf6" stroke-width="1" stroke-dasharray="3,3" fill="none" marker-end="url(#arrowPurple)" opacity="0.6"/>
  <rect x="830" y="602" width="90" height="14" rx="2" fill="#0a0e17"/>
  <text x="875" y="612" text-anchor="middle" fill="#a78bfa" font-size="7">binary download</text>

  <!-- ═══════════════════════════════════════════════════════ -->
  <!-- X-Scanner-Key AUTH BADGES                              -->
  <!-- ═══════════════════════════════════════════════════════ -->
  <rect x="115" y="330" width="170" height="16" rx="3" fill="#f59e0b" fill-opacity="0.12" stroke="#f59e0b" stroke-width="0.5" stroke-opacity="0.4"/>
  <text x="200" y="341" text-anchor="middle" fill="#fbbf24" font-size="7.5" font-weight="600">X-Scanner-Key authentication</text>

  <rect x="615" y="330" width="170" height="16" rx="3" fill="#f59e0b" fill-opacity="0.12" stroke="#f59e0b" stroke-width="0.5" stroke-opacity="0.4"/>
  <text x="700" y="341" text-anchor="middle" fill="#fbbf24" font-size="7.5" font-weight="600">X-Scanner-Key authentication</text>

  <!-- ═══════════════════════════════════════════════════════ -->
  <!-- LEGEND BAR (bottom)                                    -->
  <!-- ═══════════════════════════════════════════════════════ -->
  <rect x="40" y="845" width="1020" height="40" rx="8" fill="#1e293b" fill-opacity="0.5" stroke="#334155" stroke-width="0.5"/>

  <!-- Legend dots -->
  <circle cx="70" cy="858" r="4" fill="#f59e0b"/>
  <text x="80" y="862" fill="#94a3b8" font-size="8">Cloudflare</text>
  <circle cx="150" cy="858" r="4" fill="#0ea5e9"/>
  <text x="160" y="862" fill="#94a3b8" font-size="8">Hetzner</text>
  <circle cx="220" cy="858" r="4" fill="#10b981"/>
  <text x="230" y="862" fill="#94a3b8" font-size="8">On-Prem</text>
  <circle cx="290" cy="858" r="4" fill="#8b5cf6"/>
  <text x="300" y="862" fill="#94a3b8" font-size="8">CI/CD</text>

  <text x="400" y="862" fill="#64748b" font-size="8">All scanner connections outbound-only port 443</text>
  <text x="400" y="876" fill="#64748b" font-size="8">X-Scanner-Key auth • No inbound ports required • Zero VPN</text>

  <!-- Lock icon -->
  <rect x="990" y="850" width="55" height="28" rx="4" fill="#10b981" fill-opacity="0.1" stroke="#10b981" stroke-width="0.5" stroke-opacity="0.3"/>
  <text x="1018" y="869" text-anchor="middle" fill="#34d399" font-size="9" font-weight="700">SECURE</text>
</svg>
