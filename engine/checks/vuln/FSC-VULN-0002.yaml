# ForgeScan Check Definition
# CVE-2023-44487 - HTTP/2 Rapid Reset Attack

id: "FSC-VULN-0002"
name: "HTTP/2 Rapid Reset Attack"
description: |
  The HTTP/2 protocol allows a denial of service (server resource consumption)
  because request cancellation can reset many streams quickly, as exploited in
  the wild in August through October 2023.
category: vulnerability
severity: high

cve_ids:
  - CVE-2023-44487

cwe_ids:
  - CWE-400

compliance:
  - framework: "NIST-800-53"
    control: "SC-5"
  - framework: "PCI-DSS"
    control: "6.2"

detection:
  type: banner-match
  protocol: http
  patterns:
    - pattern: "nginx/(1\\.(2[0-4]|[01][0-9]))"
      product: "nginx"
      vulnerable: true
    - pattern: "Apache/(2\\.4\\.([0-4][0-9]|5[0-7]))"
      product: "Apache"
      vulnerable: true

remediation: |
  Update to patched versions:
  - nginx: 1.25.3 or later
  - Apache: 2.4.58 or later
  - Go: 1.20.10, 1.21.3 or later
  - Node.js: Apply latest security patches

references:
  - "https://nvd.nist.gov/vuln/detail/CVE-2023-44487"
  - "https://www.cisa.gov/news-events/alerts/2023/10/10/http2-rapid-reset-attack"

enabled_by_default: true
