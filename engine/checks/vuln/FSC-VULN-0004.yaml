# ForgeScan Check Definition
# OpenSSH Vulnerable Versions

id: "FSC-VULN-0004"
name: "OpenSSH RegreSSHion RCE (CVE-2024-6387)"
description: |
  A race condition vulnerability exists in OpenSSH's server (sshd) that can
  allow an unauthenticated remote attacker to achieve remote code execution
  as root on glibc-based Linux systems. This is a regression of CVE-2006-5051.
category: vulnerability
severity: critical

cve_ids:
  - CVE-2024-6387

cwe_ids:
  - CWE-362
  - CWE-364

compliance:
  - framework: "NIST-800-53"
    control: "SI-2"
  - framework: "NIST-800-53"
    control: "AC-17"

detection:
  type: banner-match
  protocol: ssh
  patterns:
    - pattern: "SSH-2\\.0-OpenSSH_([89]\\.[0-7]p1|8\\.([0-9]p1)|9\\.[0-7]p1)"
      vulnerable: true
    - pattern: "SSH-2\\.0-OpenSSH_4\\.4p1"
      vulnerable: false
  cpe: "cpe:2.3:a:openbsd:openssh:*"
  affected_versions:
    - ">= 8.5p1"
    - "< 9.8p1"

remediation: |
  Upgrade OpenSSH to version 9.8p1 or later.

  Temporary mitigations:
  - Set LoginGraceTime to 0 in sshd_config (WARNING: exposes to DoS)
  - Implement network-level access controls to limit SSH exposure
  - Monitor for exploitation attempts

references:
  - "https://nvd.nist.gov/vuln/detail/CVE-2024-6387"
  - "https://www.qualys.com/2024/07/01/cve-2024-6387/regresshion.txt"
  - "https://www.openssh.com/security.html"

enabled_by_default: true
