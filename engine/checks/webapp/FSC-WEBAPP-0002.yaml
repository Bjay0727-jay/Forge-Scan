# ForgeScan Check Definition
# SSL/TLS Configuration Issues

id: "FSC-WEBAPP-0002"
name: "Weak SSL/TLS Configuration"
description: |
  The web server is configured with weak SSL/TLS settings that could
  allow attackers to intercept or decrypt encrypted communications.
category: webapp
severity: high

cwe_ids:
  - CWE-326
  - CWE-327

compliance:
  - framework: "NIST-800-53"
    control: "SC-8"
  - framework: "PCI-DSS"
    control: "4.1"
  - framework: "OWASP"
    control: "A02:2021"

detection:
  type: tls-check
  checks:
    - name: "SSLv3 Enabled"
      protocol: "SSLv3"
      severity: critical
      finding: "SSLv3 is enabled (POODLE vulnerability)"
    - name: "TLS 1.0 Enabled"
      protocol: "TLSv1.0"
      severity: high
      finding: "TLS 1.0 is enabled (deprecated and insecure)"
    - name: "TLS 1.1 Enabled"
      protocol: "TLSv1.1"
      severity: medium
      finding: "TLS 1.1 is enabled (deprecated)"
    - name: "Weak Ciphers"
      cipher_pattern: "(RC4|DES|3DES|NULL|EXPORT|anon)"
      severity: high
      finding: "Weak cipher suites are supported"
    - name: "Missing TLS 1.3"
      protocol: "TLSv1.3"
      expect: true
      severity: info
      finding: "TLS 1.3 is not supported"

remediation: |
  1. Disable SSLv3, TLS 1.0, and TLS 1.1
  2. Enable TLS 1.2 and TLS 1.3 only
  3. Use strong cipher suites only
  4. Enable Perfect Forward Secrecy (ECDHE/DHE)
  5. Use certificates with RSA 2048+ or ECDSA 256+

  Example nginx configuration:
    ssl_protocols TLSv1.2 TLSv1.3;
    ssl_ciphers ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256;
    ssl_prefer_server_ciphers on;

references:
  - "https://ssl-config.mozilla.org/"
  - "https://www.ssllabs.com/ssltest/"
  - "https://wiki.mozilla.org/Security/Server_Side_TLS"

enabled_by_default: true
